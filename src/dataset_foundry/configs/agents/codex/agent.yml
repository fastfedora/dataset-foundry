container:
  image: "codex-agent:latest"
  build:
    # Use `configs` as the Docker build context so we can COPY files like `shared/setup-repo.sh`
    context: ../..
    dockerfile: agents/codex/Dockerfile
  environment:
    OPENAI_API_KEY: "${OPENAI_API_KEY}"
    # Set in `agent_runner` to be model string from `CODEX_MODEL` or `DF_MODEL`
    CODEX_MODEL: "${AGENT_MODEL}"
  command: ["printenv OPENAI_API_KEY | codex login --with-api-key && cat input/prompt.md | codex exec --model \"$CODEX_MODEL\" --dangerously-bypass-approvals-and-sandbox --skip-git-repo-check"]
